{"version":3,"file":"index.esm.js","sources":["../../src/modal/index.tsx"],"sourcesContent":["import React from 'react';\nimport { Box } from '../box';\nimport { Flex, FlexProps } from '../flex';\nimport { ModalContextTypes, ModalProps, WrapperComponentProps } from './types';\nimport useOnClickOutside from 'use-onclickoutside';\n\nconst ModalContext = React.createContext<ModalContextTypes>({\n  isOpen: false,\n});\n\nexport const useModalState = () => React.useContext(ModalContext);\n\nconst Header = React.memo(({ component }: WrapperComponentProps) =>\n  component ? (\n    <Box borderTopRightRadius=\"6px\" borderTopLeftRadius=\"6px\">\n      {component}\n    </Box>\n  ) : null\n);\n\nconst Footer = React.memo(({ component }: WrapperComponentProps) =>\n  component ? (\n    <Box borderBottomRightRadius=\"6px\" borderBottomLeftRadius=\"6px\">\n      {component}\n    </Box>\n  ) : null\n);\n\ninterface ModalUnderlayProps {\n  isOpen?: boolean;\n  noAnimation?: boolean;\n}\n\nconst ModalUnderlay = ({ isOpen, noAnimation }: ModalUnderlayProps) => (\n  <Box\n    position=\"fixed\"\n    size=\"100%\"\n    left={0}\n    right={0}\n    top={0}\n    bottom={0}\n    bg={`rgba(0,0,0,${isOpen ? '0.48' : '0'})`}\n    transition={noAnimation ? 'unset' : 'all 0.15s'}\n    zIndex={99999}\n    style={{\n      userSelect: isOpen ? 'unset' : 'none',\n      pointerEvents: isOpen ? 'unset' : 'none',\n      willChange: 'background',\n    }}\n  />\n);\ninterface ModalWrapperProps extends FlexProps {\n  isOpen: boolean;\n}\n\nconst ModalWrapper = ({ isOpen, ...rest }: ModalWrapperProps) => (\n  <Flex\n    zIndex={999999}\n    position=\"fixed\"\n    bottom={[0, 'unset']}\n    width=\"100%\"\n    top={0}\n    left={0}\n    height=\"100%\"\n    maxHeight={['100vh', 'unset']}\n    alignItems=\"center\"\n    justifyContent={['flex-end', 'center']}\n    flexDirection=\"column\"\n    opacity={isOpen ? 1 : 0}\n    style={{\n      userSelect: isOpen ? 'unset' : 'none',\n      pointerEvents: isOpen ? 'unset' : 'none',\n    }}\n    {...rest}\n  />\n);\n\ninterface ModalCardContainerProps extends FlexProps {\n  isOpen: boolean;\n  noAnimation: boolean;\n}\n\nconst ModalCardContainer = React.forwardRef<any, ModalCardContainerProps>(\n  ({ noAnimation, isOpen, ...rest }, ref) => (\n    <Flex\n      flexDirection=\"column\"\n      position=\"relative\"\n      bg=\"white\"\n      mx=\"auto\"\n      minWidth={['100%', '396px']}\n      maxWidth={['100%', '396px']}\n      maxHeight={['100%', 'calc(100% - 48px)']}\n      borderRadius={['unset', '6px']}\n      boxShadow=\"high\"\n      transform={noAnimation ? 'translateY(0px)' : isOpen ? 'translateY(0px)' : 'translateY(15px)'}\n      transition={noAnimation ? 'unset' : 'all 0.2s ease-in-out'}\n      style={{\n        willChange: 'transform',\n      }}\n      ref={ref}\n      {...rest}\n    />\n  )\n);\n\nexport const Modal: React.FC<ModalProps> = React.memo(\n  ({\n    footerComponent: FooterComponent = null,\n    headerComponent: HeaderComponent = null,\n    isOpen = false,\n    children,\n    noAnimation = false,\n    close,\n    ...props\n  }) => {\n    const { doCloseModal } = useModalState();\n    const ref = React.useRef(null);\n\n    React.useEffect(() => {\n      const func = (event: KeyboardEvent) => {\n        if (event.key === 'Escape') {\n          if (close) {\n            close();\n          } else if (doCloseModal) {\n            doCloseModal();\n          }\n        }\n      };\n\n      if (isOpen) {\n        typeof window !== 'undefined' &&\n          window?.document?.createElement &&\n          document.addEventListener('keydown', func);\n      }\n      return () => {\n        typeof window !== 'undefined' &&\n          window?.document?.createElement &&\n          document.removeEventListener('keydown', func);\n      };\n    }, [isOpen, close]);\n\n    const handler = isOpen ? close || doCloseModal || null : null;\n\n    useOnClickOutside(ref, handler);\n\n    return (\n      <>\n        <ModalUnderlay isOpen={isOpen} noAnimation={noAnimation} />\n        <ModalWrapper isOpen={isOpen}>\n          <ModalCardContainer ref={ref} isOpen={isOpen} noAnimation={noAnimation} {...props}>\n            <Header component={HeaderComponent} />\n            <Box overflowY=\"auto\">{children}</Box>\n            <Footer component={FooterComponent} />\n          </ModalCardContainer>\n        </ModalWrapper>\n      </>\n    );\n  }\n);\n\nexport const ModalProvider: React.FC = props => {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const doOpenModal = () => (!isOpen ? setIsOpen(true) : null);\n  const doCloseModal = () => (isOpen ? setIsOpen(false) : null);\n  return (\n    <ModalContext.Provider\n      value={{\n        isOpen,\n        doOpenModal,\n        doCloseModal,\n      }}\n    >\n      {props.children}\n    </ModalContext.Provider>\n  );\n};\n"],"names":["ModalContext","React","createContext","isOpen","useModalState","useContext","Header","memo","component","Box","borderTopRightRadius","borderTopLeftRadius","Footer","borderBottomRightRadius","borderBottomLeftRadius","ModalUnderlay","noAnimation","position","size","left","right","top","bottom","bg","transition","zIndex","style","userSelect","pointerEvents","willChange","ModalWrapper","rest","Flex","width","height","maxHeight","alignItems","justifyContent","flexDirection","opacity","ModalCardContainer","forwardRef","ref","mx","minWidth","maxWidth","borderRadius","boxShadow","transform","Modal","footerComponent","FooterComponent","headerComponent","HeaderComponent","children","close","props","doCloseModal","useRef","useEffect","func","event","key","window","document","createElement","addEventListener","removeEventListener","handler","useOnClickOutside","overflowY","ModalProvider","useState","setIsOpen","doOpenModal","Provider","value"],"mappings":"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"}