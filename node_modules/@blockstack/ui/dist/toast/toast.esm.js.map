{"version":3,"file":"toast.esm.js","sources":["../../src/toast/toast.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useRef } from 'react';\nimport ReachAlert from '@reach/alert';\nimport { useRect } from '@reach/rect';\nimport { useId } from '@reach/auto-id';\n\nimport { Transition } from '../transition';\nimport { Stack } from '../stack';\nimport { Box, BoxProps } from '../box';\nimport { Flex } from '../flex';\nimport { Text } from '../text';\nimport { ExclamationMarkCircleIcon, CheckmarkCircleIcon, CloseIcon } from '../icons';\n\nimport { useTimeout } from '../hooks';\n\nimport { ActionProps, ToastAction, ToastProps } from './types';\nimport { useHover, useFocus } from 'use-events';\nimport { transition } from '../theme/theme';\n\nconst toneToIcon = {\n  critical: ExclamationMarkCircleIcon,\n  positive: CheckmarkCircleIcon,\n  none: () => null,\n};\n\nconst Action = ({ label, onClick, removeToast, ...rest }: ActionProps) => {\n  const handleClick = useCallback(() => {\n    removeToast();\n    onClick();\n  }, [removeToast, onClick]);\n\n  return (\n    <Box\n      _hover={{\n        cursor: 'pointer',\n        textDecoration: 'underline',\n      }}\n      onClick={handleClick}\n      aria-hidden\n      {...rest}\n    >\n      <Text>{label}</Text>\n    </Box>\n  );\n};\n\nconst getCustomProps = (props: ToastProps['toastProps'] = {}) => {\n  return {\n    message: {\n      color: 'ink',\n      ...props?.message,\n    },\n    description: {\n      color: 'ink.600',\n      ...props?.description,\n    },\n    toast: {\n      background: 'white',\n      borderColor: 'inherit',\n      boxShadow: 'high',\n      ...props?.toast,\n    },\n    icon: {\n      ...props?.icon,\n      color: {\n        critical: 'red',\n        positive: 'green',\n        ...props?.icon?.color,\n      },\n    },\n    close: {\n      color: 'ink.600',\n      ...props?.close,\n    },\n    action: {\n      color: 'blue',\n      fontSize: '14px',\n      ...props?.action,\n    },\n  };\n};\n\nconst CloseButton = ({ onClick, ...rest }: any) => {\n  const [hover, bind] = useHover();\n  const [focus, focusBind] = useFocus();\n  return (\n    <Flex\n      position=\"relative\"\n      justify=\"center\"\n      cursor={hover ? 'pointer' : 'unset'}\n      onClick={onClick}\n      {...bind}\n      {...rest}\n    >\n      <Box\n        ml=\"tight\"\n        mt=\"extra-tight\"\n        opacity={hover ? 1 : 0.5}\n        as=\"button\"\n        role=\"button\"\n        aria-label=\"Close popup\"\n        title=\"Close\"\n        style={{\n          outline: 'none',\n        }}\n        position=\"relative\"\n        zIndex={99}\n        transition={transition}\n        {...focusBind}\n      >\n        <CloseIcon size=\"12px\" />\n      </Box>\n      <Box\n        size=\"24px\"\n        bg=\"currentColor\"\n        borderRadius=\"100%\"\n        position=\"absolute\"\n        left=\"-50%\"\n        top=\"-50%\"\n        opacity={hover ? 0.1 : 0}\n        transform=\"translate3d(12px, 6px, 0)\"\n        transition={transition}\n        boxShadow={focus ? 'focus' : 'unset'}\n      />\n    </Flex>\n  );\n};\n\nconst Description: React.FC<BoxProps> = ({ children, ...rest }) => (\n  <Text\n    fontSize=\"14px\"\n    style={{\n      wordBreak: 'break-word',\n    }}\n    display=\"block\"\n    {...rest}\n  >\n    {children}\n  </Text>\n);\n\nconst Message: React.FC<BoxProps> = ({ children, ...rest }) => (\n  <Text fontWeight=\"600\" display=\"block\" {...rest}>\n    {children}\n  </Text>\n);\n\nconst ToastContent = ({\n  styles = {},\n  message,\n  description,\n  action,\n  remove,\n  ...rest\n}: {\n  styles: ToastProps['toastProps'];\n  message: string;\n  description?: string;\n  action?: ToastAction;\n  remove: () => void;\n}) =>\n  description ? (\n    <Stack spacing=\"tight\" {...rest}>\n      <Message {...styles?.message}>{message}</Message>\n      {description ? <Description {...styles?.description}>{description}</Description> : null}\n      {action ? (\n        <Action key={action.label} removeToast={remove} {...action} {...styles.action} />\n      ) : null}\n    </Stack>\n  ) : (\n    <Stack spacing=\"tight\" {...rest}>\n      <Message {...styles?.message}>{message}</Message>\n      {action ? (\n        <Action key={action.label} removeToast={remove} {...action} {...styles.action} />\n      ) : null}\n    </Stack>\n  );\n\nexport const Toast = React.forwardRef<HTMLDivElement, ToastProps>(\n  ({ id: propsId, message, description, tone = 'none', onClear, action, toastProps = {} }, ref) => {\n    const id = useId(propsId) as string;\n    const styles = useMemo(() => getCustomProps(toastProps), [toastProps]);\n    const remove = useCallback(() => onClear(id), [onClear, id]);\n    const toastRef = useRef<HTMLDivElement>(null);\n    const rect = useRect(toastRef);\n    const [show, setShow] = React.useState(true);\n\n    const height = rect?.height ?? 0;\n\n    const onExit = () => {\n      if (!show) {\n        onClear(id);\n      }\n    };\n\n    const onClose = React.useCallback(() => {\n      setShow(false);\n    }, []);\n\n    const { stopTimeout, startTimeout } = useTimeout({\n      duration: 7200,\n      onTimeout: onClose,\n    });\n\n    const animationStyles = {\n      init: {\n        opacity: 0,\n        height: 0,\n        transform: 'scale(1)',\n      },\n      entered: {\n        opacity: 1,\n        height,\n        transform: 'scale(1)',\n      },\n      exiting: {\n        opacity: 0,\n        height: 0,\n        transform: 'scale(0.9)',\n      },\n    };\n\n    const noIcon = tone === 'none';\n    const Icon = toneToIcon[tone];\n\n    return (\n      <Transition styles={animationStyles} in={show} onExited={onExit} timeout={350}>\n        {transitionStyles => (\n          <Box\n            onMouseEnter={stopTimeout}\n            onMouseLeave={startTimeout}\n            style={{\n              willChange: 'transform, height, opacity',\n              ...transitionStyles,\n            }}\n            ref={ref}\n          >\n            <Flex\n              justify=\"center\"\n              as={ReachAlert}\n              maxWidth=\"100%\"\n              pb=\"tight\"\n              px=\"tight\"\n              ref={toastRef}\n            >\n              <Box\n                p=\"base\"\n                border=\"1px solid\"\n                borderColor=\"inherit\"\n                borderRadius=\"6px\"\n                maxWidth=\"100%\"\n                {...styles.toast}\n                style={{\n                  pointerEvents: 'all',\n                }}\n              >\n                <Box position=\"relative\">\n                  <Flex align=\"flex-start\">\n                    {tone !== 'none' ? (\n                      <Box\n                        pt=\"extra-tight\"\n                        pr=\"tight\"\n                        {...styles?.icon}\n                        color={styles.icon.color[tone]}\n                      >\n                        <Icon size=\"16px\" />\n                      </Box>\n                    ) : null}\n\n                    <Box pr={noIcon ? 'unset' : 'base'}>\n                      <ToastContent\n                        message={message}\n                        description={description}\n                        action={action}\n                        styles={styles}\n                        remove={remove}\n                      />\n                    </Box>\n\n                    <CloseButton onClick={onClose} />\n                  </Flex>\n                </Box>\n              </Box>\n            </Flex>\n          </Box>\n        )}\n      </Transition>\n    );\n  }\n);\n"],"names":["toneToIcon","critical","ExclamationMarkCircleIcon","positive","CheckmarkCircleIcon","none","Action","label","onClick","removeToast","rest","handleClick","useCallback","React","Box","_hover","cursor","textDecoration","Text","getCustomProps","props","message","color","description","toast","background","borderColor","boxShadow","icon","close","action","fontSize","CloseButton","useHover","hover","bind","useFocus","focus","focusBind","Flex","position","justify","ml","mt","opacity","as","role","title","style","outline","zIndex","transition","CloseIcon","size","bg","borderRadius","left","top","transform","Description","children","wordBreak","display","Message","fontWeight","ToastContent","styles","remove","Stack","spacing","key","Toast","forwardRef","ref","propsId","id","tone","onClear","toastProps","useId","useMemo","toastRef","useRef","rect","useRect","useState","show","setShow","height","onExit","onClose","useTimeout","duration","onTimeout","stopTimeout","startTimeout","animationStyles","init","entered","exiting","noIcon","Icon","Transition","onExited","timeout","transitionStyles","onMouseEnter","onMouseLeave","willChange","ReachAlert","maxWidth","pb","px","p","border","pointerEvents","align","pt","pr"],"mappings":"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"}