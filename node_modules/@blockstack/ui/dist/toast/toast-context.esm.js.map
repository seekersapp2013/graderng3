{"version":3,"file":"toast-context.esm.js","sources":["../../src/toast/toast-context.tsx"],"sourcesContent":["import React, { useContext, createContext, useReducer, useCallback } from 'react';\n\nimport { Portal } from '../portal';\nimport { Toaster } from './toaster';\n\nimport { ToastType, AddToast, ToastState, ToastProviderProps } from './types';\n\nlet toastCounter = 0;\n\nconst ToastControllerContext = createContext<AddToast | null>(null);\n\nconst QUEUE_TOAST = 0;\nconst REMOVE_TOAST = 1;\n\ntype Actions =\n  | { type: typeof QUEUE_TOAST; payload: ToastType }\n  | { type: typeof REMOVE_TOAST; payload: string };\n\nfunction reducer(state: ToastState, action: Actions): ToastState {\n  switch (action.type) {\n    case QUEUE_TOAST: {\n      return {\n        ...state,\n        toasts: [...state.toasts, action.payload],\n      };\n    }\n\n    case REMOVE_TOAST: {\n      const toasts = state.toasts.filter(({ id }) => id !== action.payload);\n\n      return {\n        ...state,\n        toasts,\n      };\n    }\n  }\n\n  return state;\n}\n\nconst InternalToastProvider = ({ children }: ToastProviderProps) => {\n  const [{ toasts }, dispatch] = useReducer(reducer, {\n    toasts: [],\n  });\n\n  const addToast = useCallback(\n    (props: ToastType) => dispatch({ type: QUEUE_TOAST, payload: props }),\n    []\n  );\n\n  const removeToast = useCallback(\n    (id: string) => dispatch({ type: REMOVE_TOAST, payload: id }),\n    []\n  );\n\n  return (\n    <ToastControllerContext.Provider value={addToast}>\n      {children}\n      <Portal>\n        <Toaster toasts={toasts} removeToast={removeToast} />\n      </Portal>\n    </ToastControllerContext.Provider>\n  );\n};\n\nexport const ToastProvider = ({ children }: ToastProviderProps) => {\n  const currentContext = useContext(ToastControllerContext);\n\n  if (currentContext !== null) {\n    // Bail early as \"ToastProvider\" is already setup\n    return <>{children}</>;\n  }\n\n  return <InternalToastProvider>{children}</InternalToastProvider>;\n};\n\nexport const useToast = () => {\n  const addToast = useContext(ToastControllerContext);\n\n  if (addToast === null) {\n    throw new Error('No \"ToastProvider\" configured');\n  }\n\n  return useCallback(\n    (props: Omit<ToastType, 'id'>) => addToast({ ...props, id: `${toastCounter++}` }),\n    [addToast]\n  );\n};\n"],"names":["toastCounter","ToastControllerContext","createContext","QUEUE_TOAST","REMOVE_TOAST","reducer","state","action","type","toasts","payload","filter","id","InternalToastProvider","children","useReducer","dispatch","addToast","useCallback","props","removeToast","React","Provider","value","Portal","Toaster","ToastProvider","currentContext","useContext","useToast","Error"],"mappings":";;;;;AAOA,IAAIA,YAAY,GAAG,CAAnB;AAEA,IAAMC,sBAAsB,gBAAGC,aAAa,CAAkB,IAAlB,CAA5C;AAEA,IAAMC,WAAW,GAAG,CAApB;AACA,IAAMC,YAAY,GAAG,CAArB;;AAMA,SAASC,OAAT,CAAiBC,KAAjB,EAAoCC,MAApC;AACE,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKL,WAAL;AAAkB;AAChB,kCACKG,KADL;AAEEG,UAAAA,MAAM,YAAMH,KAAK,CAACG,MAAZ,GAAoBF,MAAM,CAACG,OAA3B;AAFR;AAID;;AAED,SAAKN,YAAL;AAAmB;AACjB,YAAMK,MAAM,GAAGH,KAAK,CAACG,MAAN,CAAaE,MAAb,CAAoB;AAAA,cAAGC,EAAH,QAAGA,EAAH;AAAA,iBAAYA,EAAE,KAAKL,MAAM,CAACG,OAA1B;AAAA,SAApB,CAAf;AAEA,kCACKJ,KADL;AAEEG,UAAAA,MAAM,EAANA;AAFF;AAID;AAfH;;AAkBA,SAAOH,KAAP;AACD;;AAED,IAAMO,qBAAqB,GAAG,SAAxBA,qBAAwB;MAAGC,iBAAAA;;oBACAC,UAAU,CAACV,OAAD,EAAU;AACjDI,IAAAA,MAAM,EAAE;AADyC,GAAV;MAAhCA,wBAAAA;MAAUO;;AAInB,MAAMC,QAAQ,GAAGC,WAAW,CAC1B,UAACC,KAAD;AAAA,WAAsBH,QAAQ,CAAC;AAAER,MAAAA,IAAI,EAAEL,WAAR;AAAqBO,MAAAA,OAAO,EAAES;AAA9B,KAAD,CAA9B;AAAA,GAD0B,EAE1B,EAF0B,CAA5B;AAKA,MAAMC,WAAW,GAAGF,WAAW,CAC7B,UAACN,EAAD;AAAA,WAAgBI,QAAQ,CAAC;AAAER,MAAAA,IAAI,EAAEJ,YAAR;AAAsBM,MAAAA,OAAO,EAAEE;AAA/B,KAAD,CAAxB;AAAA,GAD6B,EAE7B,EAF6B,CAA/B;AAKA,SACES,4BAAA,CAACpB,sBAAsB,CAACqB,QAAxB;AAAiCC,IAAAA,KAAK,EAAEN;GAAxC,EACGH,QADH,EAEEO,4BAAA,CAACG,MAAD,MAAA,EACEH,4BAAA,CAACI,OAAD;AAAShB,IAAAA,MAAM,EAAEA;AAAQW,IAAAA,WAAW,EAAEA;GAAtC,CADF,CAFF,CADF;AAQD,CAvBD;;IAyBaM,aAAa,GAAG,SAAhBA,aAAgB;MAAGZ,iBAAAA;AAC9B,MAAMa,cAAc,GAAGC,UAAU,CAAC3B,sBAAD,CAAjC;;AAEA,MAAI0B,cAAc,KAAK,IAAvB,EAA6B;AAE3B,WAAON,4BAAA,wBAAA,MAAA,EAAGP,QAAH,CAAP;AACD;;AAED,SAAOO,4BAAA,CAACR,qBAAD,MAAA,EAAwBC,QAAxB,CAAP;AACD;IAEYe,QAAQ,GAAG,SAAXA,QAAW;AACtB,MAAMZ,QAAQ,GAAGW,UAAU,CAAC3B,sBAAD,CAA3B;;AAEA,MAAIgB,QAAQ,KAAK,IAAjB,EAAuB;AACrB,UAAM,IAAIa,KAAJ,CAAU,+BAAV,CAAN;AACD;;AAED,SAAOZ,WAAW,CAChB,UAACC,KAAD;AAAA,WAAkCF,QAAQ,oBAAME,KAAN;AAAaP,MAAAA,EAAE,OAAKZ,YAAY;AAAhC,OAA1C;AAAA,GADgB,EAEhB,CAACiB,QAAD,CAFgB,CAAlB;AAID;;;;"}